From 504e345b25603ca2f8896db82a4293351ba7cc4f Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Hugo=20Beauz=C3=A9e-Luyssen?= <hugo@beauzee.fr>
Date: Thu, 16 Jun 2016 15:56:54 +0200
Subject: [PATCH] headers: Adjust header guards for Windows 10

---
 mingw-w64-headers/include/iphlpapi.h | 8 ++++++--
 mingw-w64-headers/include/iprtrmib.h | 5 +++++
 mingw-w64-headers/include/mprapi.h   | 6 ++++++
 mingw-w64-headers/include/nldef.h    | 2 +-
 4 files changed, 18 insertions(+), 3 deletions(-)

diff --git a/mingw-w64-headers/include/iphlpapi.h b/mingw-w64-headers/include/iphlpapi.h
index 03aed33..5523f81 100644
--- a/mingw-w64-headers/include/iphlpapi.h
+++ b/mingw-w64-headers/include/iphlpapi.h
@@ -8,8 +8,6 @@
 
 #include <winapifamily.h>
 
-#if WINAPI_FAMILY_PARTITION (WINAPI_PARTITION_DESKTOP)
-
 #ifdef __cplusplus
 extern "C" {
 #endif
@@ -19,6 +17,10 @@ extern "C" {
 #include <iptypes.h>
 #include <tcpestats.h>
 
+#if WINAPI_FAMILY_PARTITION (WINAPI_PARTITION_DESKTOP) || _WIN32_WINNT >= 0x0A00
+
+#if WINAPI_FAMILY_PARTITION (WINAPI_PARTITION_DESKTOP)
+
   DWORD WINAPI GetNumberOfInterfaces (PDWORD pdwNumIf);
   DWORD WINAPI GetIfEntry (PMIB_IFROW pIfRow);
   DWORD WINAPI GetIfTable (PMIB_IFTABLE pIfTable, PULONG pdwSize, WINBOOL bOrder);
@@ -94,6 +96,8 @@ extern "C" {
   ULONG WINAPI GetAdaptersInfo (PIP_ADAPTER_INFO AdapterInfo, PULONG SizePointer);
   PIP_ADAPTER_ORDER_MAP WINAPI GetAdapterOrderMap (VOID);
 
+#endif
+
 #ifdef _WINSOCK2API_
   ULONG WINAPI GetAdaptersAddresses (ULONG Family, ULONG Flags, PVOID Reserved, PIP_ADAPTER_ADDRESSES AdapterAddresses, PULONG SizePointer);
 #endif
diff --git a/mingw-w64-headers/include/iprtrmib.h b/mingw-w64-headers/include/iprtrmib.h
index 93e0cad..65ca264 100644
--- a/mingw-w64-headers/include/iprtrmib.h
+++ b/mingw-w64-headers/include/iprtrmib.h
@@ -6,6 +6,9 @@
 #ifndef __ROUTING_IPRTRMIB_H__
 #define __ROUTING_IPRTRMIB_H__
 
+#include <winapifamily.h>
+#if WINAPI_FAMILY_PARTITION (WINAPI_PARTITION_DESKTOP)
+
 #include <mprapi.h>
 #include <ipmib.h>
 #include <ipifcons.h>
@@ -772,4 +775,6 @@ typedef enum _TCPIP_OWNER_MODULE_INFO_CLASS {
 
 #define CAST_MIB_INFO(X,Y,Z) Z = (Y)(X->rgbyData)
 
+#endif /*WINAPI_FAMILY_PARTITION (WINAPI_PARTITION_DESKTOP)*/
+
 #endif /* __ROUTING_IPRTRMIB_H__ */
diff --git a/mingw-w64-headers/include/mprapi.h b/mingw-w64-headers/include/mprapi.h
index 2103c2b..7bbc1d7 100644
--- a/mingw-w64-headers/include/mprapi.h
+++ b/mingw-w64-headers/include/mprapi.h
@@ -9,6 +9,10 @@
 #include <lmcons.h>
 #include <ras.h>
 
+#include <winapifamily.h>
+
+#if WINAPI_FAMILY_PARTITION (WINAPI_PARTITION_DESKTOP)
+
 #ifdef __cplusplus
 extern "C" {
 #endif
@@ -991,4 +995,6 @@ DWORD APIENTRY MprAdminServerSetInfoEx(
 }
 #endif
 
+#endif /* WINAPI_FAMILY_PARTITION (WINAPI_PARTITION_DESKTOP) */
+
 #endif /* __ROUTING_MPRADMIN_H__ */
diff --git a/mingw-w64-headers/include/nldef.h b/mingw-w64-headers/include/nldef.h
index 5a6a767..e61f104 100644
--- a/mingw-w64-headers/include/nldef.h
+++ b/mingw-w64-headers/include/nldef.h
@@ -7,7 +7,7 @@
 #define _NLDEF_
 #include <winapifamily.h>
 
-#if WINAPI_FAMILY_PARTITION (WINAPI_PARTITION_DESKTOP)
+#if WINAPI_FAMILY_PARTITION (WINAPI_PARTITION_DESKTOP) || _WIN32_WINNT >= 0x0A00
 
 typedef enum {
   NldsInvalid,
-- 
2.8.1

